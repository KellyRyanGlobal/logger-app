pipeline {
    agent none
    environment {
        DOCKER_USER = credentials('docker-username')
        DOCKER_PASS = credentials('docker-password')
        APP_NAME = 'test_app'
        VERSION = '1.0'
    }
    stages {
        stage('Docker Build Test_App') {
            agent { dockerfile true
                }
            steps {
                sh 'ls'
                sh 'pwd'
                stash includes: '${APP_NAME}.exe', name: 'test'
            }
        }
        stage('Test out stash') {
            agent { dockerfile true
                }
            steps {
                sh 'echo "unstash ${APP_NAME}"'
                unstash 'test'
                sh './${APP_NAME}.exe'
            }
        }
    }

}